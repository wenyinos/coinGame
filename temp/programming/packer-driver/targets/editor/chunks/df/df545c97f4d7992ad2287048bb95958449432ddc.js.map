{"version":3,"sources":["file:///D:/MyCoding/Cosos/coinGame/assets/scripts/frame/CommonUtils.ts"],"names":["CommonUtils","quatFromAngleY","out","y","halfToRad","x","z","Math","sin","w","cos","Sprite","Node","tween","Layers","Vec3","sys","UITransform","Widget","view","UIRenderer","DataType","PI","ONE","ZERO","hideRender","node","render","getComponent","_renderFlag","_renderEntity","enabled","showRender","hideRenders","renders","getComponentsInChildren","forEach","showRenders","save","key","val","saveLocalStorage","load","type","NUMBER","res","loadLocalStorage","STRING","Number","OBJECT","JSON","parse","localStorage","setItem","getItem","formatPercentage","num","toFixed","traverseObject","obj","callback","hasOwnProperty","value","getDay","floor","Date","now","createUI","name","layer","Enum","UI_2D","size","getVisibleSize","transfrom","addComponent","setContentSize","widget","isAlignLeft","isAlignTop","isAlignBottom","right","left","top","bottom","getDateId","d","dates","toString","getHours","getMinutes","getSeconds","result","random","isEn","navigator","language","indexOf","clearUI","clear","sp","clearSprite","sps","length","v","destroy","MoveTowards","current","target","maxDistanceDelta","toVector_x","toVector_y","sqdist","set","dist","sqrt","fadeIn","dura","scale","to","start","fixedTo","precision","perc","getRandomTarget","targets","L","getQueryVariable","variable","url","decodeURIComponent","window","location","href","str","split","query","vars","i","pair","getCloestNode","self","closestNode","dis","_node","_dis","getNodesDis","end","getMdis2D","position","getOne","p1","p2","abs","getMdisXZ","fadeOut","cb","easing","call","sf","spriteFrame","refCount","decRef","tex","texture","clearTex","image","COMMONUTILS"],"mappings":"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","sourcesContent":["\r\nimport { _decorator, Sprite, SpriteFrame, Texture2D, ImageAsset, Node, screen, tween, Layers, Vec3, sys, UITransform, Widget, view, PolygonCollider2D, director, game, UIRenderer, IQuatLike } from 'cc';\r\nimport { DataType } from './Enums';\r\n\r\nconst halfToRad = 0.5 * Math.PI / 180.0;\r\n\r\nconst ONE = new Vec3(1, 1, 1);\r\n\r\nconst ZERO = new Vec3(0, 0, 0);\r\n\r\nexport function quatFromAngleY<Out extends IQuatLike>(out: Out, y: number) {\r\n    y *= halfToRad;\r\n    out.x = out.z = 0;\r\n    out.y = Math.sin(y);\r\n    out.w = Math.cos(y);\r\n    return out;\r\n}\r\n\r\n\r\n\r\nclass CommonUtils {\r\n\r\n    hideRender(node: Node): void {\r\n\r\n        const render = node.getComponent(UIRenderer);\r\n        if (!render) return;\r\n\r\n        //@ts-ignore\r\n        render._renderFlag = false;\r\n        //@ts-ignore\r\n        render._renderEntity.enabled = false;\r\n\r\n\r\n    }\r\n    showRender(node: Node): void {\r\n\r\n        const render = node.getComponent(UIRenderer);\r\n\r\n\r\n        if (!render) return;\r\n        //@ts-ignore\r\n        render._renderFlag = true;\r\n        //@ts-ignore\r\n        render._renderEntity.enabled = true;\r\n\r\n    }\r\n\r\n    hideRenders(node: Node): void {\r\n\r\n        const renders = node.getComponentsInChildren(UIRenderer);\r\n\r\n        renders.forEach((render) => {\r\n            //@ts-ignore\r\n            render._renderFlag = false;\r\n            //@ts-ignore\r\n            render._renderEntity.enabled = false;\r\n        })\r\n\r\n    }\r\n    showRenders(node: Node): void {\r\n\r\n        const renders = node.getComponentsInChildren(UIRenderer);\r\n\r\n        renders.forEach((render) => {\r\n            //@ts-ignore\r\n            render._renderFlag = true;\r\n            //@ts-ignore\r\n            render._renderEntity.enabled = true;\r\n        })\r\n    }\r\n\r\n    save(key: any, val: string | number | any) {\r\n        if (typeof val === \"number\") {\r\n            val = \"\" + val as string;\r\n        }\r\n        /* 这里可以存云端 */\r\n        this.saveLocalStorage(key, val || '')\r\n    }\r\n    /**\r\n     * @description: load localstorage data,\r\n     * @return {*}\r\n     */\r\n    load(key: string, type: DataType.STRING | DataType.NUMBER | DataType.OBJECT = DataType.NUMBER) {\r\n        /* 这里可以从云端拿 */\r\n        let res: any = this.loadLocalStorage(key);\r\n\r\n        if (res) {\r\n            switch (type) {\r\n                case DataType.STRING:\r\n                    break;\r\n                case DataType.NUMBER:\r\n                    res = Number(res);\r\n                    break;\r\n                case DataType.OBJECT:\r\n                    res = JSON.parse(res);\r\n                    break;\r\n            }\r\n            return res;\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * @description: save data into localstorage\r\n     * @return {*}\r\n     */\r\n    saveLocalStorage(key: any, val: string | number | any) {\r\n        sys.localStorage.setItem(key, val || '')\r\n    }\r\n\r\n    /**\r\n     * @description: load localstorage data,\r\n     * @return {*}\r\n     */\r\n    loadLocalStorage(key: string) {\r\n        return sys.localStorage.getItem(key);\r\n    }\r\n\r\n\r\n    /**\r\n     * @en : formate num to percentage\r\n     * @cn : 数字转换成百分比\r\n     * @param {number} num\r\n     */\r\n    formatPercentage(num: number): string | number {\r\n        if (num < 2) {\r\n            return (num * 100).toFixed(1) + '%';\r\n        } else {\r\n            return num;\r\n        }\r\n    }\r\n\r\n    traverseObject(obj: any, callback: (key: string, value: any) => void): void {\r\n        for (const key in obj) {\r\n            if (obj.hasOwnProperty(key)) {\r\n                const value = obj[key];\r\n                callback(key, value);\r\n                if (typeof value === 'object') {\r\n                    this.traverseObject(value, callback);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    getDay() {\r\n        return Math.floor(Date.now() / (1000 * 60 * 60 * 24));\r\n    }\r\n\r\n    createUI(name: string = \"uiNode\", layer: number = Layers.Enum.UI_2D): Node {\r\n        const size = view.getVisibleSize();\r\n        const node = new Node(name)\r\n        const transfrom = node.addComponent(UITransform);\r\n        transfrom.setContentSize(size);\r\n        const widget = node.addComponent(Widget);\r\n        widget.isAlignLeft = widget.isAlignTop = widget.isAlignTop = widget.isAlignBottom = true;\r\n        widget.right = widget.left = widget.top = widget.bottom = 0;\r\n        node.layer = layer;\r\n        return node;\r\n    }\r\n\r\n    /**\r\n     * @description: generate a random data;\r\n     * @return {*}\r\n     */\r\n    getDateId(): string {\r\n\r\n        let d = new Date();\r\n\r\n        let dates = d.getDay().toString() + d.getHours().toString() + d.getMinutes().toString() + d.getSeconds().toString();\r\n\r\n        let result = Math.floor(Number(dates) + Math.floor(Math.random() * (500000 * Math.random() + 50000)) * 0.1);\r\n\r\n        return result.toString();\r\n    }\r\n\r\n\r\n    /**\r\n     * @description: get the sys language\r\n     * @return {*}\r\n     */\r\n    isEn(): boolean {\r\n        return (navigator.language.indexOf(\"zh\") != -1) ? false : true;\r\n    }\r\n\r\n    /**\r\n     * @description: Clear UI node, and realse sprite's memory based on needs\r\n     * @param {Node} node\r\n     * @param {*} clear\r\n     * @return {*}\r\n     */\r\n    clearUI(node: Node, clear = true) {\r\n\r\n        if (clear) {\r\n            const sp = node.getComponent(Sprite);\r\n            sp && this.clearSprite(sp);\r\n            const sps = node.getComponentsInChildren(Sprite);\r\n            if (sps.length > 0) {\r\n                sps.forEach((v) => {\r\n                    /* Release mem */\r\n                    this.clearSprite(v);\r\n                })\r\n            }\r\n\r\n        }\r\n        node.destroy();\r\n    }\r\n    /**\r\n     * @Date: 2022-03-04 17:26:21\r\n     * @LastEditors: iwae\r\n     * @description: move towards\r\n     * @param {Vec3} current current vec\r\n     * @param {Vec3} target target\r\n     * @param {number} maxDistanceDelta speed delta\r\n     */\r\n    MoveTowards(current: Vec3, target: [number, number], maxDistanceDelta: number) {\r\n        // avoid vector ops because current scripting backends are terrible at inlining\r\n        const toVector_x = target[0] - current.x;\r\n        const toVector_y = target[1] - current.y;\r\n        const sqdist = toVector_x * toVector_x + toVector_y * toVector_y;\r\n        if (sqdist == 0 || (maxDistanceDelta >= 0 && sqdist <= maxDistanceDelta * maxDistanceDelta)) {\r\n            current.set(target[0], target[1]);\r\n            return true;\r\n        }\r\n        const dist = Math.sqrt(sqdist);\r\n\r\n        current.x = + toVector_x / dist * maxDistanceDelta;\r\n        current.y = + toVector_y / dist * maxDistanceDelta;\r\n\r\n        return false;\r\n    }\r\n\r\n\r\n    /* node fade In */\r\n    fadeIn(node: Node, dura = 0.2) {\r\n        tween(node).set({ scale: Vec3.ZERO }).to(dura, { scale: ONE }).start();\r\n    }\r\n\r\n    fixedTo(num: number, precision = 2) {\r\n\r\n        const perc = 10 ^ precision;\r\n\r\n        num = Math.floor(num * perc) / perc;\r\n\r\n        return num;\r\n\r\n    }\r\n\r\n    /**\r\n     * @description: get a random target from targets\r\n     * @return {*}\r\n     */\r\n    getRandomTarget(targets: Node[]): Node {\r\n\r\n        let target: Node;\r\n\r\n        const L = targets.length;\r\n\r\n        if (L > 0) {\r\n\r\n            target = targets[Math.floor(L * Math.random())];\r\n\r\n        } else {\r\n\r\n            target = null;\r\n        }\r\n\r\n\r\n        return target;\r\n    }\r\n\r\n    getQueryVariable(variable: string) {\r\n\r\n        const url = decodeURIComponent(window.location.href);\r\n        var str = url.split('?');\r\n        var query = str[1];\r\n        if (query) {\r\n            var vars = query.split('&');\r\n            for (var i = 0; i < vars.length; i++) {\r\n                var pair = vars[i].split(\"=\");\r\n                if (pair[0] == variable) {\r\n                    return pair[1];\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n\r\n    /**\r\n     * @description: get the closet nodes\r\n     * @return {*}\r\n     */\r\n    getCloestNode(self: Node, targets: Node[]): Node {\r\n\r\n        let closestNode: Node;\r\n\r\n        const L = targets.length;\r\n\r\n        if (L > 0) {\r\n\r\n            let dis = 10000;\r\n\r\n            for (var i = 0; i < L; i++) {\r\n\r\n                const _node = targets[i];\r\n\r\n                const _dis = this.getNodesDis(_node, self);\r\n\r\n                if (_dis < dis) {\r\n\r\n                    dis = _dis;\r\n\r\n                    closestNode = _node;\r\n                }\r\n\r\n            }\r\n\r\n        } else {\r\n\r\n            closestNode = null;\r\n        }\r\n\r\n\r\n        return closestNode;\r\n    }\r\n\r\n    /**\r\n     * @description: get node's mahatton dis to the target\r\n     * @return {*}\r\n     */\r\n    getNodesDis(start: Node, end: Node): number {\r\n        return this.getMdis2D(start.position, end.position);\r\n    }\r\n\r\n    getOne(): 1 | -1 {\r\n        return (Math.random() > 0.5) ? 1 : -1;\r\n    }\r\n\r\n    getMdis2D(p1: Vec3, p2: Vec3): number {\r\n        /* we use Manhattan dis for better performance */\r\n        const d = (Math.abs(p2.x - p1.x) + Math.abs(p2.y - p1.y));\r\n        return d;\r\n    }\r\n    /**\r\n     * @en : get Manhattan in XZ\r\n     * @zh : XZ 曼哈顿距离\r\n     * @param {Vec3} p1\r\n     * @param {Vec3} p2\r\n     */\r\n    getMdisXZ(p1: Vec3, p2: Vec3): number {\r\n        /* we use Manhattan dis for better performance */\r\n        const d = (Math.abs(p2.x - p1.x) + Math.abs(p2.z - p1.z));\r\n        return d;\r\n    }\r\n\r\n    /* node fade In */\r\n    fadeOut(node: Node, cb?) {\r\n        tween(node).to(0.2, { scale: ZERO }, { easing: 'elasticOut' }).call(() => {\r\n            cb && cb();\r\n        }).start();\r\n    }\r\n\r\n    /**\r\n     * @description: Clear sprite and release memory\r\n     * @param {Sprite} sp\r\n     * @return {*}\r\n     */\r\n    clearSprite(sp: Sprite) {\r\n        const sf = sp.spriteFrame as SpriteFrame;\r\n        if (sf) {\r\n            sp.spriteFrame = null;\r\n            if (sf && sf.refCount > 0) {\r\n                sf.decRef();\r\n                const tex = sf.texture as Texture2D;\r\n                this.clearTex(tex)\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @description: Clear texture2D and release memory\r\n     * @param {Texture2D} tex\r\n     * @return {*}\r\n     */\r\n    clearTex(tex: Texture2D) {\r\n\r\n        if (tex && tex.refCount > 0) {\r\n            tex.decRef();\r\n            const image = tex.image as ImageAsset;\r\n            if (image && image.refCount > 0) {\r\n                image.decRef();\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\nconst COMMONUTILS = new CommonUtils;\r\n\r\nexport default COMMONUTILS;\r\n"]}