{"version":3,"sources":["file:///D:/MyCoding/Cosos/coinGame/assets/scripts/combat/ctrl/ActionConfig.ts"],"names":["_decorator","Component","director","KeyCode","Label","sys","aa","events","ui","KeyConfigView","ccclass","property","ctrl","ActionConfig","time","_moveForward","down","h","up","_moveBackward","_moveLeft","v","_moveRight","_danceAction","jump","_rapAction","rap","_basketballAction","ball","_skillConfigs","dance","cd","basketball","onEnable","isMobile","add","KEY_W","labels","KEY_S","KEY_A","KEY_D","KEY_X","KEY_C","KEY_K","onDisable","remove","showConfig","configView","res","getUI","ConfigView","getComponent","init","isPlaying","emit","playerAnm","update","dt"],"mappings":"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","sourcesContent":["import { _decorator, Component, director, KeyCode, Label, Node, sys } from 'cc';\r\nimport { aa } from '../../frame/FrameCore';\r\nimport { KeyEvent } from '../../frame/input/InputCtrl';\r\nimport { events, ui } from '../../frame/Enums';\r\nimport { KeyConfigView } from '../../view/KeyConfigView';\r\nconst { ccclass, property } = _decorator;\r\nconst ctrl = aa.ctrl;\r\n\r\n@ccclass('ActionConfig')\r\nexport class ActionConfig extends Component {\r\n\r\n    @property(Label)\r\n    labels:Label[] = [];\r\n\r\n    public time = 0;\r\n\r\n    _moveForward: KeyEvent = {\r\n        down: () => {\r\n            ctrl.h = 1;\r\n        },\r\n        up: () => {\r\n            (ctrl.h > 0) && (ctrl.h = 0);\r\n        }\r\n    }\r\n    _moveBackward: KeyEvent = {\r\n        down: () => {\r\n            ctrl.h = -1;\r\n        },\r\n        up: () => {\r\n            (ctrl.h < 0) && (ctrl.h = 0);\r\n        }\r\n    }\r\n    _moveLeft: KeyEvent = {\r\n        down: () => {\r\n            ctrl.v = -1\r\n        },\r\n        up: () => {\r\n            (ctrl.v < 0) && (ctrl.v = 0);\r\n        }\r\n    }\r\n    _moveRight: KeyEvent = {\r\n        down: () => {\r\n            ctrl.v = 1\r\n        },\r\n        up: () => {\r\n            (ctrl.v > 0) && (ctrl.v = 0);\r\n        }\r\n    }\r\n    _danceAction: KeyEvent = {\r\n        down: () => {\r\n            this.jump();\r\n        }\r\n    };\r\n    _rapAction: KeyEvent = {\r\n        down: () => {\r\n            this.rap();\r\n        }\r\n    };\r\n    _basketballAction: KeyEvent = {\r\n        down: () => {\r\n            this.ball();\r\n        }\r\n    };\r\n\r\n    private _skillConfigs = {\r\n        dance:{time:0,cd:5},\r\n        rap:{time:0,cd:5},\r\n        basketball:{time:0,cd:5}\r\n\r\n    }\r\n \r\n    onEnable(): void {\r\n        if (sys.isMobile) return\r\n        ctrl\r\n        .add(\"forward\",[KeyCode.KEY_W],this._moveForward,this.labels[0])\r\n        .add(\"backward\",[KeyCode.KEY_S],this._moveBackward,this.labels[1])\r\n        .add(\"left\",[KeyCode.KEY_A],this._moveLeft,this.labels[2])\r\n        .add(\"right\",[KeyCode.KEY_D],this._moveRight,this.labels[3])\r\n        .add(\"dance\",[KeyCode.KEY_X],this._danceAction,this.labels[4])\r\n        .add(\"rap\",[KeyCode.KEY_C],this._rapAction,this.labels[5])\r\n        .add(\"basketball\",[KeyCode.KEY_K],this._basketballAction,this.labels[6])\r\n    }\r\n    onDisable() {\r\n        if (sys.isMobile) return\r\n        ctrl\r\n        .remove(\"forward\")\r\n        .remove(\"backward\")\r\n        .remove(\"left\")\r\n        .remove(\"right\")\r\n        .remove(\"dance\")\r\n        .remove(\"rap\")\r\n        .remove(\"ball\")\r\n    }\r\n\r\n\r\n    async showConfig() {\r\n        const configView = await aa.res.getUI(ui.ConfigView);\r\n        configView.getComponent(KeyConfigView).init(this);\r\n    }\r\n\r\n    rap() {\r\n        if (aa.ctrl.isPlaying) return;\r\n        director.emit(events.playerAnm, \"rap\");\r\n        aa.ctrl.isPlaying = true;\r\n        this.time = 3.5;\r\n    }\r\n\r\n    jump() {\r\n        if (aa.ctrl.isPlaying) return;\r\n        director.emit(events.playerAnm, \"dance\");\r\n        aa.ctrl.isPlaying = true;\r\n        this.time = 4;\r\n    }\r\n\r\n    ball() {\r\n        if (aa.ctrl.isPlaying) return;\r\n        director.emit(events.playerAnm, \"basketball\");\r\n        aa.ctrl.isPlaying = true;\r\n        this.time = 3.5;\r\n    }\r\n \r\n    update(dt: number): void {\r\n        if (this.time <= 0) {\r\n            aa.ctrl.isPlaying = false;\r\n        } else {\r\n            this.time -= dt;\r\n        }\r\n\r\n       \r\n\r\n    }\r\n\r\n}\r\n\r\n"]}